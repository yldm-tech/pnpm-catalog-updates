export const metadata = {
  title: 'ê°œë°œ',
  description:
    'pnpm-catalog-updates ê°œë°œ í™˜ê²½ ì„¤ì •. í”„ë¡œì íŠ¸ êµ¬ì¡°, ê°œë°œ ì›Œí¬í”Œë¡œìš° ë° ê¸°ì—¬ ë°©ë²•ì„ ì•Œì•„ë³´ì„¸ìš”.',
};

# ê°œë°œ

PCU ê°œë°œ í™˜ê²½ì„ ì„¤ì •í•˜ê³  í”„ë¡œì íŠ¸ì— ê¸°ì—¬í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì„¸ìš”. ì´ ê°€ì´ë“œëŠ” í”„ë¡œì íŠ¸ ì„¤ì •, ì•„í‚¤í…ì²˜ ë° ê°œë°œ ì›Œí¬í”Œë¡œìš°ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤. {{ className: 'lead' }}

## ì‚¬ì „ ìš”êµ¬ì‚¬í•­

PCU ê°œë°œì„ ì‹œì‘í•˜ê¸° ì „ì— í•„ìš”í•œ ë„êµ¬ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”:

<Note>ê°œë°œì„ ìœ„í•´ì„œëŠ” Node.js >= 22.0.0ê³¼ pnpm >= 10.0.0ì´ í•„ìš”í•©ë‹ˆë‹¤.</Note>

<CodeGroup>

```bash {{ title: 'ë²„ì „ í™•ì¸' }}
node --version  # 22.0.0 ì´ìƒì´ì–´ì•¼ í•¨
pnpm --version  # 10.0.0 ì´ìƒì´ì–´ì•¼ í•¨
```

```bash {{ title: 'ë„êµ¬ ì„¤ì¹˜' }}
# nvmì„ í†µí•œ Node.js ì„¤ì¹˜ (ê¶Œì¥)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 22
nvm use 22

# pnpm ì„¤ì¹˜
npm install -g pnpm@latest
```

</CodeGroup>

## í”„ë¡œì íŠ¸ ì„¤ì •

ê°œë°œ í™˜ê²½ì„ ë³µì œí•˜ê³  ì„¤ì •í•˜ì„¸ìš”:

<CodeGroup>

```bash {{ title: 'ë³µì œ ë° ì„¤ì •' }}
# ì €ì¥ì†Œ ë³µì œ
git clone https://github.com/houko/pnpm-catalog-updates.git
cd pnpm-catalog-updates

# ì¢…ì†ì„± ì„¤ì¹˜
pnpm install

# í”„ë¡œì íŠ¸ ë¹Œë“œ
pnpm build

# í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ ì„¤ì • í™•ì¸
pnpm test
```

```bash {{ title: 'ê°œë°œ ëª¨ë“œ' }}
# ê°œë°œ ëª¨ë“œë¡œ ì‹¤í–‰
pnpm dev --help

# ê°ì‹œ ëª¨ë“œë¡œ ë¹Œë“œ
pnpm build:watch

# ê°ì‹œ ëª¨ë“œë¡œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
pnpm test:watch
```

</CodeGroup>

## í”„ë¡œì íŠ¸ ì•„í‚¤í…ì²˜

PCUëŠ” ê´€ì‹¬ì‚¬ì˜ ëª…í™•í•œ ë¶„ë¦¬ì™€ í•¨ê»˜ í´ë¦° ì•„í‚¤í…ì²˜ ì›ì¹™ì„ ë”°ë¦…ë‹ˆë‹¤:

```text
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ cli/                    # CLI ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ
â”‚   â”‚   â”œâ”€â”€ src/cli/           # CLI ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ commands/      # ëª…ë ¹ í•¸ë“¤ëŸ¬
â”‚   â”‚   â”‚   â”œâ”€â”€ formatters/    # ì¶œë ¥ í¬ë§¤í„°
â”‚   â”‚   â”‚   â”œâ”€â”€ interactive/   # ëŒ€í™”í˜• í”„ë¡¬í”„íŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ themes/        # ìƒ‰ìƒ í…Œë§ˆ
â”‚   â”‚   â”‚   â””â”€â”€ validators/    # ì…ë ¥ ìœ íš¨ì„± ê²€ì‚¬
â”‚   â”‚   â””â”€â”€ bin/               # ì‹¤í–‰ ê°€ëŠ¥í•œ ë°”ì´ë„ˆë¦¬
â”‚   â””â”€â”€ docs/                  # ë¬¸ì„œ ì‚¬ì´íŠ¸
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ core/                  # í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ application/   # ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤
â”‚   â”‚       â”œâ”€â”€ domain/        # ë„ë©”ì¸ ëª¨ë¸ (DDD)
â”‚   â”‚       â””â”€â”€ infrastructure/# ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ê³„ì¸µ
â”‚   â””â”€â”€ utils/                 # ê³µìœ  ìœ í‹¸ë¦¬í‹°
â””â”€â”€ scripts/                   # ë¹Œë“œ ë° ë°°í¬
```

### ì•„í‚¤í…ì²˜ ê³„ì¸µ

<Properties>
  <Property name="CLI ê³„ì¸µ" type="apps/cli">
    ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤, ëª…ë ¹ íŒŒì‹±, ì¶œë ¥ í¬ë§¤íŒ…
  </Property>
  <Property name="ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ" type="packages/core/application">
    ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜, ì‚¬ìš© ì‚¬ë¡€
  </Property>
  <Property name="ë„ë©”ì¸ ê³„ì¸µ" type="packages/core/domain">
    í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ì—”í‹°í‹°, ê°’ ê°ì²´, ì €ì¥ì†Œ ì¸í„°í˜ì´ìŠ¤
  </Property>
  <Property name="ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ê³„ì¸µ" type="packages/core/infrastructure">
    ì™¸ë¶€ API í´ë¼ì´ì–¸íŠ¸, íŒŒì¼ ì‹œìŠ¤í…œ ì ‘ê·¼, ì €ì¥ì†Œ êµ¬í˜„
  </Property>
  <Property name="ìœ í‹¸ë¦¬í‹° ê³„ì¸µ" type="packages/utils">
    ê³µìœ  ìœ í‹¸ë¦¬í‹°, êµ¬ì„±, ë¡œê¹…, ì˜¤ë¥˜ ì²˜ë¦¬
  </Property>
</Properties>

## ê°œë°œ ì›Œí¬í”Œë¡œìš°

### ë³€ê²½ ì‚¬í•­ ë§Œë“¤ê¸°

1. **ê¸°ëŠ¥ ë¸Œëœì¹˜ ìƒì„±**:

   ```bash
   git checkout -b feature/amazing-feature
   ```

2. **ì½”ë”© í‘œì¤€ì„ ë”°ë¼ ë³€ê²½ ì‚¬í•­ ì‘ì„±**

3. **ë³€ê²½ ì‚¬í•­ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ì¶”ê°€**:

   ```bash
   pnpm test:watch  # ê°ì‹œ ëª¨ë“œë¡œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
   ```

4. **í’ˆì§ˆ ê²€ì‚¬ í†µê³¼ í™•ì¸**:

   ```bash
   pnpm lint        # ì½”ë“œ ìŠ¤íƒ€ì¼ í™•ì¸
   pnpm typecheck   # íƒ€ì… ê²€ì‚¬
   pnpm test        # ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰
   ```

5. **ë³€ê²½ ì‚¬í•­ ì»¤ë°‹**:
   ```bash
   git commit -m 'feat: add amazing feature'
   ```

### í…ŒìŠ¤íŠ¸ ì „ëµ

PCUëŠ” í¬ê´„ì ì¸ í…ŒìŠ¤íŠ¸ ì ‘ê·¼ ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:

<CodeGroup>

```bash {{ title: 'ë‹¨ìœ„ í…ŒìŠ¤íŠ¸' }}
# ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
pnpm test

# ì»¤ë²„ë¦¬ì§€ì™€ í•¨ê»˜ ì‹¤í–‰
pnpm test:coverage

# íŠ¹ì • íŒ¨í‚¤ì§€ í…ŒìŠ¤íŠ¸
pnpm --filter @pcu/core test
```

```bash {{ title: 'E2E í…ŒìŠ¤íŠ¸' }}
# End-to-End í…ŒìŠ¤íŠ¸ ì‹¤í–‰
pnpm test:e2e

# ì‹¤ì œ í”„ë¡œì íŠ¸ì— ëŒ€í•´ í…ŒìŠ¤íŠ¸
pnpm test:e2e --project example-workspace
```

```bash {{ title: 'í†µí•© í…ŒìŠ¤íŠ¸' }}
# CLI ëª…ë ¹ í…ŒìŠ¤íŠ¸
pnpm test:cli

# ë‹¤ë¥¸ Node ë²„ì „ìœ¼ë¡œ í…ŒìŠ¤íŠ¸
nvm use 18 && pnpm test
nvm use 20 && pnpm test
nvm use 22 && pnpm test
```

</CodeGroup>

### ì½”ë“œ í’ˆì§ˆ

PCUëŠ” ë†’ì€ ì½”ë“œ í’ˆì§ˆ í‘œì¤€ì„ ìœ ì§€í•©ë‹ˆë‹¤:

<CodeGroup>

```bash {{ title: 'ë¦°íŒ… ë° í¬ë§¤íŒ…' }}
# ì½”ë“œ ìŠ¤íƒ€ì¼ í™•ì¸
pnpm lint

# ë¦°íŒ… ë¬¸ì œ ìˆ˜ì •
pnpm lint:fix

# ì½”ë“œ í¬ë§·
pnpm format

# TypeScript íƒ€ì… í™•ì¸
pnpm typecheck
```

```json {{ title: 'í’ˆì§ˆ ê¸°ì¤€' }}
{
  "coverage": {
    "statements": 85,
    "branches": 80,
    "functions": 85,
    "lines": 85
  },
  "lint": "TypeScript ê·œì¹™ì´ í¬í•¨ëœ ESLint",
  "format": "ì‚¬ìš©ì ì •ì˜ ì„¤ì •ì„ ì‚¬ìš©í•œ Prettier",
  "types": "ì—„ê²©í•œ TypeScript êµ¬ì„±"
}
```

</CodeGroup>

## ê¸°ëŠ¥ ì¶”ê°€

### ìƒˆ ëª…ë ¹ ë§Œë“¤ê¸°

1. **ëª…ë ¹ í•¸ë“¤ëŸ¬ ìƒì„±** in `apps/cli/src/cli/commands/`:

<CodeGroup>

```typescript {{ title: 'newCommand.ts' }}
import { Command } from 'commander';
import { GlobalOptions } from '../options';

export function createNewCommand(): Command {
  return new Command('new')
    .description('ìƒˆ ëª…ë ¹ì— ëŒ€í•œ ì„¤ëª…')
    .option('-f, --format <type>', 'ì¶œë ¥ í˜•ì‹', 'table')
    .action(async (options: NewCommandOptions) => {
      // ëª…ë ¹ êµ¬í˜„
    });
}

interface NewCommandOptions extends GlobalOptions {
  format: string;
}
```

```typescript {{ title: 'ëª…ë ¹ ë“±ë¡' }}
// apps/cli/src/cli/index.tsì—ì„œ
import { createNewCommand } from './commands/newCommand';

program.addCommand(createNewCommand());
```

</CodeGroup>

2. **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¶”ê°€** in `packages/core/src/application/services/`

3. **CLIì™€ í•µì‹¬ ë¡œì§ ëª¨ë‘ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ìƒì„±**

4. **ë¬¸ì„œ ì—…ë°ì´íŠ¸**

### ìƒˆ ì¶œë ¥ í˜•ì‹ ì¶”ê°€

1. **í¬ë§¤í„° ìƒì„±** in `apps/cli/src/cli/formatters/`:

```typescript {{ title: 'xmlFormatter.ts' }}
import { OutputFormatter, FormattedOutput } from './outputFormatter';

export class XmlFormatter implements OutputFormatter {
  format(data: any): FormattedOutput {
    // XML í¬ë§¤íŒ… ë¡œì§
    return {
      content: xmlContent,
      type: 'xml',
    };
  }
}
```

2. **ì£¼ í¬ë§¤í„° ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— í¬ë§¤í„° ë“±ë¡**

3. **í…ŒìŠ¤íŠ¸ ì¶”ê°€** ë° **ë¬¸ì„œ ì—…ë°ì´íŠ¸**

## ê¸°ì—¬ ê°€ì´ë“œë¼ì¸

### ì»¤ë°‹ ë©”ì‹œì§€ ê·œì¹™

PCUëŠ” [Conventional Commits](https://conventionalcommits.org/)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:

<CodeGroup>

```bash {{ title: 'ì»¤ë°‹ íƒ€ì…' }}
feat: ìƒˆë¡œìš´ ê¸°ëŠ¥
fix: ë²„ê·¸ ìˆ˜ì •
docs: ë¬¸ì„œë§Œ ë³€ê²½
style: ì½”ë“œ ìŠ¤íƒ€ì¼ ë³€ê²½ (í¬ë§¤íŒ… ë“±)
refactor: ë²„ê·¸ë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ì§€ ì•ŠëŠ” ì½”ë“œ ë³€ê²½
test: ëˆ„ë½ëœ í…ŒìŠ¤íŠ¸ ì¶”ê°€ ë˜ëŠ” ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ìˆ˜ì •
chore: ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ ë˜ëŠ” ë³´ì¡° ë„êµ¬ ë³€ê²½
```

```bash {{ title: 'ì˜ˆì‹œ' }}
feat: ì‚¬ìš©ì ì •ì˜ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì§€ì› ì¶”ê°€
fix: ë„¤íŠ¸ì›Œí¬ íƒ€ì„ì•„ì›ƒì„ ìš°ì•„í•˜ê²Œ ì²˜ë¦¬
docs: êµ¬ì„± ì˜ˆì‹œ ì—…ë°ì´íŠ¸
test: íŒ¨í‚¤ì§€ í•„í„°ë§ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ì¶”ê°€
```

</CodeGroup>

### Pull Request í”„ë¡œì„¸ìŠ¤

1. **ì €ì¥ì†Œ í¬í¬** ë° ê¸°ëŠ¥ ë¸Œëœì¹˜ ìƒì„±
2. **ê°œë°œ ì›Œí¬í”Œë¡œìš°ì— ë”°ë¼ ë³€ê²½ ì‚¬í•­ ì‘ì„±**
3. **ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼** ë° ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬ ì„±ê³µ í™•ì¸
4. **í•„ìš”ì‹œ ë¬¸ì„œ ì—…ë°ì´íŠ¸**
5. **ë‹¤ìŒì„ í¬í•¨í•œ pull request ì œì¶œ**:
   - ë³€ê²½ ì‚¬í•­ì— ëŒ€í•œ ëª…í™•í•œ ì„¤ëª…
   - ê´€ë ¨ ì´ìŠˆ ë§í¬
   - UI ë³€ê²½ì— ëŒ€í•œ ìŠ¤í¬ë¦°ìƒ·
   - í•´ë‹¹ë˜ëŠ” ê²½ìš° Breaking Change ë…¸íŠ¸

### ì½”ë“œ ë¦¬ë·° ì²´í¬ë¦¬ìŠ¤íŠ¸

1. ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼
2. ì½”ë“œ ì»¤ë²„ë¦¬ì§€ ìœ ì§€ (>85%)
3. TypeScript íƒ€ì…ì´ ì˜¬ë°”ë¦„
4. ì½”ë“œ ìŠ¤íƒ€ì¼ì´ í”„ë¡œì íŠ¸ í‘œì¤€ì„ ë”°ë¦„
5. ë¬¸ì„œ ì—…ë°ì´íŠ¸ë¨
6. Breaking Changes ë¬¸ì„œí™”ë¨
7. ì„±ëŠ¥ ì˜í–¥ ê³ ë ¤ë¨

## ë””ë²„ê¹…

### ê°œë°œ ë””ë²„ê¹…

<CodeGroup>

```bash {{ title: 'CLI ëª…ë ¹ ë””ë²„ê·¸' }}
# Node.js ì¸ìŠ¤í™í„°ë¡œ ë””ë²„ê·¸
node --inspect-brk ./apps/cli/bin/pcu.js --help

# VS Codeë¡œ ë””ë²„ê·¸
# .vscode/launch.jsonì˜ ì‹¤í–‰ êµ¬ì„± ì‚¬ìš©
```

```bash {{ title: 'ìƒì„¸ ë¡œê¹…' }}
# ë””ë²„ê·¸ ë¡œê¹… í™œì„±í™”
DEBUG=pcu:* pnpm dev --verbose

# íŠ¹ì • ëª¨ë“ˆ ë””ë²„ê·¸
DEBUG=pcu:core,pcu:cli pcu -c
```

</CodeGroup>

### í…ŒìŠ¤íŠ¸ ë””ë²„ê¹…

```bash
# íŠ¹ì • í…ŒìŠ¤íŠ¸ ë””ë²„ê·¸
npm test -- --grep "specific test name"

# Node ì¸ìŠ¤í™í„°ë¡œ ë””ë²„ê·¸
node --inspect-brk node_modules/.bin/vitest run
```

## ë¹Œë“œ ë° ë°°í¬

### ë¡œì»¬ í…ŒìŠ¤íŠ¸

<CodeGroup>

```bash {{ title: 'ë¡œì»¬ ë¹Œë“œ í…ŒìŠ¤íŠ¸' }}
# ë¡œì»¬ì—ì„œ ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸
pnpm build
pnpm --filter @pcu/cli start --help

# ì„¤ì¹˜ í…ŒìŠ¤íŠ¸
npm pack apps/cli
npm install -g pcu-*.tgz
```

```bash {{ title: 'ì˜ˆì‹œ í”„ë¡œì íŠ¸ì—ì„œ í…ŒìŠ¤íŠ¸' }}
# ì˜ˆì‹œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì‚¬ìš©
cd apps/example
pcu -c
pcu -u --dry-run
```

</CodeGroup>

### ë¦´ë¦¬ìŠ¤ í”„ë¡œì„¸ìŠ¤

1. **changesetì„ ì‚¬ìš©í•˜ì—¬ ë²„ì „ ì—…ë°ì´íŠ¸**:

   ```bash
   pnpm changeset
   pnpm changeset version
   ```

2. **ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸**:

   ```bash
   pnpm build
   pnpm test
   pnpm test:e2e
   ```

3. **ë°°í¬** (ê´€ë¦¬ìë§Œ):
   ```bash
   pnpm publish -r
   ```

## ë„ì›€ ë°›ê¸°

- ğŸ“– **ë¬¸ì„œ**: ìì„¸í•œ ê°€ì´ë“œëŠ” ì´ ë¬¸ì„œë¥¼ í™•ì¸í•˜ì„¸ìš”
- ğŸ› **ì´ìŠˆ**: [GitHub Issues](https://github.com/houko/pnpm-catalog-updates/issues)ë¥¼ í†µí•´ ë²„ê·¸ ì‹ ê³ 
- ğŸ’¬ **í† ë¡ **: [GitHub Discussions](https://github.com/houko/pnpm-catalog-updates/discussions)ì—ì„œ ì§ˆë¬¸í•˜ê¸°
- ğŸ”§ **ê°œë°œ**: ì´ìŠˆ ë° PRì—ì„œ ê°œë°œ í† ë¡  ì°¸ì—¬

---

## ê³ ê¸‰ ì•„í‚¤í…ì²˜ ì„¸ë¶€ì‚¬í•­

### í•µì‹¬ ë„ë©”ì¸ ëª¨ë¸

Domain-Driven Design (DDD) ì›ì¹™ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ PCUì˜ í•µì‹¬ ë„ë©”ì¸:

<CodeGroup>

```typescript {{ title: 'ë„ë©”ì¸ ì—”í‹°í‹°' }}
// packages/core/src/domain/entities/
â”œâ”€â”€ catalog.ts          // ì¹´íƒˆë¡œê·¸ ì§‘ê³„ ë£¨íŠ¸
â”œâ”€â”€ package.ts          // íŒ¨í‚¤ì§€ ì—”í‹°í‹°
â””â”€â”€ workspace.ts        // ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì§‘ê³„ ë£¨íŠ¸

// ì£¼ìš” ë„ë©”ì¸ ê°œë…:
interface Catalog {
  readonly id: CatalogId;
  readonly name: string;
  packages: PackageCollection;
  addPackage(packageInfo: Package): void;
  updatePackage(name: string, version: Version): void;
}

interface Package {
  readonly name: string;
  readonly currentVersion: Version;
  readonly latestVersion: Version;
  readonly updateType: UpdateType;
}
```

```typescript {{ title: 'ê°’ ê°ì²´' }}
// packages/core/src/domain/value-objects/
â”œâ”€â”€ version.ts           // ì‹œë§¨í‹± ë²„ì „ ì²˜ë¦¬
â”œâ”€â”€ workspacePath.ts     // ê²½ë¡œ ìœ íš¨ì„± ê²€ì‚¬
â”œâ”€â”€ workspaceConfig.ts   // êµ¬ì„± ê°ì²´
â””â”€â”€ catalogCollection.ts // ì»¬ë ‰ì…˜ ê´€ë¦¬

// ë¶ˆë³€ ê°’ ê°ì²´ê°€ ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥
class Version {
  constructor(private readonly value: string) {
    if (!this.isValid(value)) {
      throw new InvalidVersionError(value);
    }
  }

  toString(): string { return this.value; }
  compare(other: Version): number { /* semver ë¹„êµ */ }
}
```

</CodeGroup>

### ì„œë¹„ìŠ¤ ê³„ì¸µ ì•„í‚¤í…ì²˜

ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µì€ ì„œë¹„ìŠ¤ë¥¼ í†µí•´ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜í•©ë‹ˆë‹¤:

<CodeGroup>

```typescript {{ title: 'ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤' }}
// packages/core/src/application/services/
â”œâ”€â”€ catalogUpdateService.ts  // ì£¼ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
â””â”€â”€ workspaceService.ts      // ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì‘ì—…

// ì„œë¹„ìŠ¤ ì±…ì„:
class CatalogUpdateService {
  async checkForUpdates(options: CheckOptions): Promise<UpdateReport>;
  async updateCatalog(options: UpdateOptions): Promise<UpdateResult>;
  async analyzeImpact(catalog: string, package: string): Promise<ImpactAnalysis>;
}
```

```typescript {{ title: 'ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ê³„ì¸µ' }}
// packages/core/src/infrastructure/
â”œâ”€â”€ external-services/
â”‚   â””â”€â”€ npmRegistryService.ts   // NPM API í´ë¼ì´ì–¸íŠ¸
â”œâ”€â”€ repositories/
â”‚   â””â”€â”€ fileWorkspaceRepository.ts  // íŒŒì¼ ì‹œìŠ¤í…œ ì§€ì†ì„±
â”œâ”€â”€ cache/
â”‚   â””â”€â”€ cache.ts                # ê³ ê¸‰ ìºì‹± ì‹œìŠ¤í…œ
â””â”€â”€ utils/
    â””â”€â”€ npmrcParser.ts          # êµ¬ì„± íŒŒì‹±

// ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ê°€ ë„ë©”ì¸ ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„:
class FileWorkspaceRepository implements WorkspaceRepository {
  async findWorkspace(path: string): Promise<Workspace | null>;
  async saveWorkspace(workspace: Workspace): Promise<void>;
}
```

</CodeGroup>

### CLI ê³„ì¸µ ë””ìì¸

CLI ê³„ì¸µì€ í•µì‹¬ ë„ë©”ì¸ì— ëŒ€í•œ ê¹”ë”í•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤:

<CodeGroup>

```typescript {{ title: 'ëª…ë ¹ êµ¬ì¡°' }}
// apps/cli/src/cli/commands/
â”œâ”€â”€ checkCommand.ts     // í™•ì¸ ëª…ë ¹ êµ¬í˜„
â”œâ”€â”€ updateCommand.ts    // ìœ íš¨ì„± ê²€ì‚¬ê°€ í¬í•¨ëœ ì—…ë°ì´íŠ¸ ëª…ë ¹
â”œâ”€â”€ analyzeCommand.ts   // ì˜í–¥ ë¶„ì„ ëª…ë ¹
â”œâ”€â”€ workspaceCommand.ts # ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ê´€ë¦¬
â”œâ”€â”€ themeCommand.ts     # í…Œë§ˆ êµ¬ì„±
â”œâ”€â”€ securityCommand.ts  # ë³´ì•ˆ ìŠ¤ìº”
â””â”€â”€ initCommand.ts      # ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì´ˆê¸°í™”

// ê° ëª…ë ¹ì€ ì¼ê´€ëœ íŒ¨í„´ì„ ë”°ë¦„:
export class CheckCommand {
  constructor(
    private readonly catalogService: CatalogUpdateService,
    private readonly validator: CommandValidator,
    private readonly formatter: OutputFormatter
  ) {}

  async execute(options: CheckCommandOptions): Promise<void> {
    const validation = this.validator.validateCheckOptions(options);
    if (!validation.isValid) {
      throw new ValidationError(validation.errors);
    }

    const result = await this.catalogService.checkForUpdates(options);
    const formatted = this.formatter.format(result, options.format);
    console.log(formatted);
  }
}
```

```typescript {{ title: 'ê³ ê¸‰ CLI ê¸°ëŠ¥' }}
// apps/cli/src/cli/
â”œâ”€â”€ validators/
â”‚   â””â”€â”€ commandValidator.ts    # ì œì•ˆì´ í¬í•¨ëœ ì…ë ¥ ìœ íš¨ì„± ê²€ì‚¬
â”œâ”€â”€ interactive/
â”‚   â””â”€â”€ interactivePrompts.ts  # ìë™ ì™„ì„±ì´ í¬í•¨ëœ ìŠ¤ë§ˆíŠ¸ í”„ë¡¬í”„íŠ¸
â”œâ”€â”€ themes/
â”‚   â””â”€â”€ colorTheme.ts          # í¬ê´„ì ì¸ í…Œë§ˆ ì‹œìŠ¤í…œ
â””â”€â”€ formatters/
    â””â”€â”€ outputFormatter.ts     # ì—¬ëŸ¬ ì¶œë ¥ í˜•ì‹

// ëŒ€í™”í˜• ê¸°ëŠ¥:
class InteractivePrompts {
  async selectPackages(packages: Package[]): Promise<string[]>;
  async confirmUpdates(updates: Update[]): Promise<boolean>;
  async configurationWizard(): Promise<Configuration>;
}
```

</CodeGroup>

### í…ŒìŠ¤íŠ¸ ì•„í‚¤í…ì²˜

ëª¨ë“  ê³„ì¸µì— ê±¸ì¹œ í¬ê´„ì ì¸ í…ŒìŠ¤íŠ¸ ì „ëµ:

<CodeGroup>

```bash {{ title: 'í…ŒìŠ¤íŠ¸ êµ¬ì¡°' }}
â”œâ”€â”€ packages/core/src/**/__tests__/     # ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ packages/utils/src/**/__tests__/    # ìœ í‹¸ë¦¬í‹° í…ŒìŠ¤íŠ¸
â”œâ”€â”€ apps/cli/src/**/__tests__/         # CLI ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ e2e/                          # End-to-End í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ integration/                  # í†µí•© í…ŒìŠ¤íŠ¸
â”‚   â””â”€â”€ fixtures/                     # í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜
â””â”€â”€ .github/workflows/
    â””â”€â”€ test.yml                      # CI í…ŒìŠ¤íŠ¸ íŒŒì´í”„ë¼ì¸
```

```typescript {{ title: 'í…ŒìŠ¤íŠ¸ íŒ¨í„´' }}
// ë„ë©”ì¸ ê³„ì¸µ í…ŒìŠ¤íŠ¸
describe('Catalog', () => {
  it('should update package version', () => {
    const catalog = new Catalog('default');
    const package = new Package('react', '18.0.0', '18.2.0');

    catalog.addPackage(package);
    catalog.updatePackage('react', new Version('18.2.0'));

    expect(catalog.getPackage('react').currentVersion.toString()).toBe('18.2.0');
  });
});

// CLI í†µí•© í…ŒìŠ¤íŠ¸
describe('CheckCommand', () => {
  it('should handle network errors gracefully', async () => {
    const mockService = createMockCatalogService();
    mockService.checkForUpdates.mockRejectedValue(new NetworkError());

    const command = new CheckCommand(mockService);

    await expect(command.execute({})).rejects.toThrow('Network error occurred');
  });
});
```

</CodeGroup>

### ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­

PCUëŠ” ëŒ€í˜• ëª¨ë…¸ë ˆí¬ì—ì„œì˜ ì„±ëŠ¥ì„ ìœ„í•´ ìµœì í™”ë˜ì—ˆìŠµë‹ˆë‹¤:

<CodeGroup>

```typescript {{ title: 'ìºì‹± ì „ëµ' }}
// ì§€ëŠ¥ì ì¸ ìºì‹±ìœ¼ë¡œ API í˜¸ì¶œ ê°ì†Œ
class Cache<T> {
  constructor(
    private readonly options: {
      ttl: number; // ìƒì¡´ ì‹œê°„
      maxSize: number; // ë©”ëª¨ë¦¬ ì œí•œ
      persistToDisk: boolean; // íŒŒì¼ ìºì‹±
      strategy: 'lru' | 'fifo' | 'lfu'; // ì œê±° ì „ëµ
    }
  ) {}

  async get(key: string): Promise<T | null>;
  async set(key: string, value: T): Promise<void>;
  getStats(): CacheStats; // ì ì¤‘ë¥ , ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰
}
```

```typescript {{ title: 'ë™ì‹œ ì²˜ë¦¬' }}
// ë” ë‚˜ì€ ì„±ëŠ¥ì„ ìœ„í•œ ë³‘ë ¬ ì²˜ë¦¬
class NpmRegistryService {
  constructor(private readonly concurrency: number = 5) {}

  async getPackageInfo(names: string[]): Promise<PackageInfo[]> {
    // ì œì–´ëœ ë™ì‹œì„±ìœ¼ë¡œ íŒ¨í‚¤ì§€ë¥¼ ë°°ì¹˜ë¡œ ì²˜ë¦¬
    const batches = chunk(names, this.concurrency);
    const results = await Promise.allSettled(batches.map((batch) => this.processBatch(batch)));

    return results.flatMap((result) => (result.status === 'fulfilled' ? result.value : []));
  }
}
```

</CodeGroup>
